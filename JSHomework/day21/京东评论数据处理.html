<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ajax-京东评论-bug</title>
</head>
<body>
<ul id="list">
    <!--<li>
            <div class="li-left">
                <div class="user-info"><img src=""/><span></span></div>
                <div class="user-level">京享值</div>
            </div>
            <div class="li-right">
                <div class="content"></div>
                <div class="message">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </li>-->
</ul>

</body>
</html>
<script>
    window.onload = () => {
        /**
         *京东评论数据处理.html
         *author:jessie-zly
         *2017/10/31
         *description:
         */

            //
        let newScript = document.createElement("script");
        newScript.src = "https://club.jd.com/comment/productPageComment.action?callback=callBack&productId=5001213&score=0&sortType=5&page=0&pageSize=10&isShadowSku=0&fold=1";


        document.body.appendChild(newScript);
//        document.body.removeChild(newScript);


    }
</script>
<script>
    /**
     *
     * @param res
     */
    function callBack(res) {
        //
        let getOul = document.querySelector("#list");
//        let str = "★★★★★☆☆☆☆☆".slice(5 - rate, 10 - rate);
        //
        for (let i in getOul) {
            let getOli = `<li>
                            <div class="li-left">
                                <div class="user-info"><img src="//${res.comments[i].userImageUrl}"/><span>${res.comments[i].nickname}</span></div>
                                <div class="user-level">京享值${res.comments[i].userExpValue}</div>
                            </div>
                            <div class="li-right">
                                <div class="content">${res.comments[i].content}</div>
                                <div class="comment-images"></div>
                                <div class="message">
                                    <span>${res.comments[i].productColor}</span>
                                    <span>${res.comments[i].productSize}</span>
                                    <span>${res.comments[i].productSales[0].saleValue}</span>
                                    <span>${res.comments[i].referenceTime}</span>
                                </div>
                            </div>
                        </li>`;
            getOul.innerHTML += getOli;
            //
            let images = document.getElementsByClassName("comment-images");
            if (res.comments[i].images) {
                for (let j in res.comments[i].images) {
                    let img = `<img src="//${res.comments[i].images[j].imgUrl}"/>`;
                    images[i].innerHTML += img;
                }
            }
        }
    }

</script>
